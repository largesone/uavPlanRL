# 自适应课程训练需求文档

## 介绍

本功能旨在为现有的课程训练（Curriculum Learning）系统引入基于智能体表现的自适应晋级机制。当前的课程训练采用固定的线性流程（Level 1 -> Level 2 -> ...），无论智能体表现如何，每个阶段都执行固定轮次数。新的自适应机制将根据智能体的实际学习表现来动态决定是否晋级到下一难度等级，确保智能体在每个难度上都达到掌握标准后才进入更高难度的学习。

## 需求

### 需求 1：配置参数管理

**用户故事：** 作为系统管理员，我希望能够灵活配置自适应课程训练的各项参数，以便根据不同的训练需求调整系统行为。

#### 验收标准

1. WHEN 系统初始化时 THEN 配置类应包含课程掌握度阈值参数（CURRICULUM_MASTERY_THRESHOLD，默认值0.80）
2. WHEN 系统初始化时 THEN 配置类应包含性能评估窗口大小参数（CURRICULUM_PERFORMANCE_WINDOW，默认值20）
3. WHEN 系统初始化时 THEN 配置类应包含单级最大训练轮次参数（CURRICULUM_MAX_EPISODES_PER_LEVEL，默认值500）
4. WHEN 系统初始化时 THEN 配置类应包含课程退步阈值参数（CURRICULUM_REGRESSION_THRESHOLD，默认值0.40）
5. WHEN 配置参数被修改时 THEN 系统应验证参数的有效性并提供错误提示

### 需求 2：自适应晋级判断机制

**用户故事：** 作为训练系统，我希望能够根据智能体在当前难度等级的表现来自动判断是否应该晋级到下一等级，以确保学习质量。

#### 验收标准

1. WHEN 智能体完成一轮训练时 THEN 系统应记录当前轮次的任务完成率到性能监控队列中
2. WHEN 性能监控队列达到指定窗口大小时 THEN 系统应计算队列中所有完成率的平均值
3. WHEN 平均完成率大于等于掌握度阈值时 THEN 系统应将智能体晋级到下一难度等级
4. WHEN 智能体晋级时 THEN 系统应清空性能监控队列并记录晋级日志
5. WHEN 智能体在当前等级训练轮次达到最大限制但未达到掌握标准时 THEN 系统应记录警告日志并决定后续处理策略

### 需求 3：性能监控和记录

**用户故事：** 作为开发者，我希望系统能够详细记录智能体在各个难度等级的学习过程，以便分析和优化训练效果。

#### 验收标准

1. WHEN 智能体在某个难度等级训练时 THEN 系统应维护一个滑动窗口来跟踪最近N轮的表现
2. WHEN 智能体达到晋级标准时 THEN 系统应输出包含平均完成率和晋级信息的日志
3. WHEN 智能体训练超时未达标时 THEN 系统应输出包含当前表现和超时信息的警告日志
4. WHEN 训练过程中 THEN 系统应记录每个难度等级的训练轮次数和达标情况
5. WHEN 训练完成时 THEN 系统应提供完整的学习曲线报告

### 需求 4：训练循环重构

**用户故事：** 作为系统架构师，我希望将现有的固定循环训练改造为动态的自适应训练循环，以支持基于表现的晋级机制。

#### 验收标准

1. WHEN 课程训练开始时 THEN 系统应初始化当前等级索引和性能监控队列
2. WHEN 进行训练循环时 THEN 系统应使用while循环替代固定的for循环，以支持动态晋级
3. WHEN 在某个难度等级训练时 THEN 系统应执行内部训练循环，最多执行指定的最大轮次数
4. WHEN 内部训练循环结束时 THEN 系统应根据表现评估结果决定是否晋级或继续当前等级
5. WHEN 所有课程等级完成时 THEN 系统应正常结束训练并保存最终模型

### 需求 5：降级机制（可选高级功能）

**用户故事：** 作为训练优化专家，我希望系统能够在智能体表现急剧下降时将其降级到之前的难度进行巩固训练，以避免学习不稳定。

#### 验收标准

1. WHEN 智能体晋级到新难度后表现持续低于退步阈值时 THEN 系统应考虑将其降级到前一难度
2. WHEN 执行降级操作时 THEN 系统应记录降级原因和相关性能数据
3. WHEN 智能体在降级后重新达到掌握标准时 THEN 系统应允许其再次尝试晋级
4. WHEN 降级次数超过限制时 THEN 系统应停止降级并继续当前等级训练
5. IF 启用降级功能 THEN 系统应提供相应的配置参数来控制降级行为

### 需求 6：兼容性保证

**用户故事：** 作为现有系统用户，我希望新的自适应机制不会影响现有的动态随机场景训练模式，确保系统的向后兼容性。

#### 验收标准

1. WHEN 使用动态随机训练模式时 THEN 系统应保持原有的训练行为不变
2. WHEN 切换到课程训练模式时 THEN 系统应使用新的自适应晋级机制
3. WHEN 系统配置中禁用自适应功能时 THEN 系统应回退到原有的固定轮次训练方式
4. WHEN 现有的训练接口被调用时 THEN 系统应保持API兼容性
5. WHEN 加载历史训练模型时 THEN 系统应能够正常继续训练而不受新功能影响